<template>
  <header class="mt-2 p-3 rounded flex justify-between items-center">
    <img src="~/public/logo.png" width="54" height="54"/>
    <span class="w-1"></span>
    <h1 class="text-4xl font-bold ">Панель администратора</h1>
    <div class="flex items-center">
      <!-- <NuxtLink class="focus:outline-none text-white bg-blue-700 hover:bg-red-800 focus:ring-4 focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-900" to="/brands">Бренды</NuxtLink> -->
      <button @click="logOut" type="button" class="focus:outline-none text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-900">Bыйти</button>
      <NuxtLink to="/" class="ml-2" @click="lang = !lang">
        <svg xmlns="http://www.w3.org/2000/svg" width="21" height="20" viewBox="0 0 21 20" fill="none">
          <mask id="mask0_247_8569" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="21" height="20">
            <circle cx="10.9766" cy="10" r="10" fill="#D9D9D9"/>
          </mask>
          <g mask="url(#mask0_247_8569)">
            <path d="M26.6015 6.58769H-4.64844V0.301757C-4.64844 0.00421067 -4.40717 -0.237061 -4.10962 -0.237061H26.0627C26.3603 -0.237061 26.6016 0.00421067 26.6016 0.301757L26.6015 6.58769Z" fill="#82AFFF"/>
            <path d="M26.0627 20.2371H-4.10962C-4.40717 20.2371 -4.64844 19.9958 -4.64844 19.6983V13.4124H26.6015V19.6983C26.6015 19.9959 26.3602 20.2371 26.0627 20.2371Z" fill="#73AF00"/>
            <path d="M26.6015 6.58769H-4.64844V13.4124H26.6015V6.58769Z" fill="#F5F5F5"/>
            <path d="M26.6015 5.98149H-4.64844V6.83244H26.6015V5.98149Z" fill="#FF4B55"/>
            <path d="M26.6016 13.1671H-4.64832V14.0181H26.6016V13.1671Z" fill="#FF4B55"/>
            <path d="M2.27808 4.87746C1.17506 4.87746 0.280956 3.9855 0.280956 2.88644C0.280956 1.78335 1.175 0.887357 2.27808 0.887357C2.28236 0.887357 2.28651 0.887357 2.29066 0.887418C2.3556 0.888273 2.37836 0.80203 2.32111 0.771329C1.98145 0.589262 1.59382 0.486235 1.18171 0.489226C-0.138111 0.498625 -1.21019 1.59231 -1.19615 2.91213C-1.18236 4.21834 -0.11449 5.27566 1.19898 5.27566C1.60542 5.27566 1.98762 5.17281 2.32307 4.99325C2.38013 4.96267 2.35706 4.87643 2.29237 4.87734C2.28748 4.87746 2.28278 4.87746 2.27808 4.87746Z" fill="#F5F5F5"/>
            <path d="M3.84148 4.32692L3.7523 4.59437L3.47038 4.59651C3.43388 4.59675 3.41875 4.64338 3.44811 4.66505L3.67491 4.83253L3.58983 5.10133C3.57884 5.13612 3.61845 5.16493 3.64818 5.14369L3.87755 4.97975L4.10692 5.14369C4.13664 5.16493 4.17619 5.13612 4.16527 5.10133L4.08018 4.83253L4.30693 4.66505C4.33629 4.64338 4.32115 4.59675 4.28465 4.59651L4.00273 4.59437L3.91356 4.32692C3.90202 4.29231 3.85307 4.29231 3.84148 4.32692Z" fill="#F5F5F5"/>
            <path d="M5.82756 4.32692L5.73839 4.59437L5.45647 4.59651C5.41997 4.59675 5.40483 4.64338 5.43419 4.66505L5.66094 4.83253L5.57585 5.10133C5.56487 5.13612 5.60448 5.16493 5.6342 5.14369L5.86357 4.97975L6.09294 5.14369C6.12267 5.16493 6.16222 5.13612 6.15129 5.10133L6.06621 4.83253L6.29295 4.66505C6.32231 4.64338 6.30718 4.59675 6.27068 4.59651L5.98876 4.59437L5.89958 4.32692C5.88805 4.29231 5.83904 4.29231 5.82756 4.32692Z" fill="#F5F5F5"/>
            <path d="M7.81364 4.32692L7.72447 4.59437L7.44255 4.59651C7.40605 4.59675 7.39092 4.64338 7.42027 4.66505L7.64708 4.83253L7.562 5.10133C7.55101 5.13612 7.59062 5.16493 7.62035 5.14369L7.84971 4.97975L8.07908 5.14369C8.10881 5.16493 8.14836 5.13612 8.13743 5.10133L8.05235 4.83253L8.2791 4.66505C8.30845 4.64338 8.29332 4.59675 8.25682 4.59651L7.9749 4.59437L7.88573 4.32692C7.87419 4.29231 7.82518 4.29231 7.81364 4.32692Z" fill="#F5F5F5"/>
            <path d="M9.79973 4.32692L9.71056 4.59437L9.42864 4.59651C9.39214 4.59675 9.377 4.64338 9.40636 4.66505L9.6331 4.83253L9.54802 5.10133C9.53703 5.13612 9.57665 5.16493 9.60637 5.14369L9.83574 4.97975L10.0651 5.14369C10.0948 5.16493 10.1344 5.13612 10.1235 5.10133L10.0384 4.83253L10.2651 4.66505C10.2945 4.64338 10.2793 4.59675 10.2428 4.59651L9.96092 4.59437L9.87175 4.32692C9.86027 4.29231 9.81126 4.29231 9.79973 4.32692Z" fill="#F5F5F5"/>
            <path d="M11.787 4.32692L11.6979 4.59437L11.4159 4.59651C11.3794 4.59675 11.3643 4.64338 11.3937 4.66505L11.6205 4.83253L11.5354 5.10133C11.5244 5.13612 11.564 5.16493 11.5937 5.14369L11.8231 4.97975L12.0525 5.14369C12.0822 5.16493 12.1217 5.13612 12.1108 5.10133L12.0257 4.83253L12.2525 4.66505C12.2819 4.64338 12.2668 4.59675 12.2303 4.59651L11.9483 4.59437L11.8592 4.32692C11.8475 4.29231 11.7986 4.29231 11.787 4.32692Z" fill="#F5F5F5"/>
            <path d="M5.82756 2.47314L5.73839 2.7406L5.45647 2.74273C5.41997 2.74298 5.40483 2.78961 5.43419 2.81127L5.66094 2.97876L5.57585 3.24755C5.56487 3.28234 5.60448 3.31115 5.6342 3.28991L5.86357 3.12597L6.09294 3.28991C6.12267 3.31115 6.16222 3.28234 6.15129 3.24755L6.06621 2.97876L6.29295 2.81127C6.32231 2.78961 6.30718 2.74298 6.27068 2.74273L5.98876 2.7406L5.89958 2.47314C5.88805 2.43841 5.83904 2.43841 5.82756 2.47314Z" fill="#F5F5F5"/>
            <path d="M7.81364 2.47314L7.72447 2.7406L7.44255 2.74273C7.40605 2.74298 7.39092 2.78961 7.42027 2.81127L7.64708 2.97876L7.562 3.24755C7.55101 3.28234 7.59062 3.31115 7.62035 3.28991L7.84971 3.12597L8.07908 3.28991C8.10881 3.31115 8.14836 3.28234 8.13743 3.24755L8.05235 2.97876L8.2791 2.81127C8.30845 2.78961 8.29332 2.74298 8.25682 2.74273L7.9749 2.7406L7.88573 2.47314C7.87419 2.43841 7.82518 2.43841 7.81364 2.47314Z" fill="#F5F5F5"/>
            <path d="M9.79973 2.47314L9.71056 2.7406L9.42864 2.74273C9.39214 2.74298 9.377 2.78961 9.40636 2.81127L9.6331 2.97876L9.54802 3.24755C9.53703 3.28234 9.57665 3.31115 9.60637 3.28991L9.83574 3.12597L10.0651 3.28991C10.0948 3.31115 10.1344 3.28234 10.1235 3.24755L10.0384 2.97876L10.2651 2.81127C10.2945 2.78961 10.2793 2.74298 10.2428 2.74273L9.96092 2.7406L9.87175 2.47314C9.86027 2.43841 9.81126 2.43841 9.79973 2.47314Z" fill="#F5F5F5"/>
            <path d="M11.787 2.47314L11.6979 2.7406L11.4159 2.74273C11.3794 2.74298 11.3643 2.78961 11.3937 2.81127L11.6205 2.97876L11.5354 3.24755C11.5244 3.28234 11.564 3.31115 11.5937 3.28991L11.8231 3.12597L12.0525 3.28991C12.0822 3.31115 12.1217 3.28234 12.1108 3.24755L12.0257 2.97876L12.2525 2.81127C12.2819 2.78961 12.2668 2.74298 12.2303 2.74273L11.9483 2.7406L11.8592 2.47314C11.8475 2.43841 11.7986 2.43841 11.787 2.47314Z" fill="#F5F5F5"/>
            <path d="M7.81364 4.32692L7.72447 4.59437L7.44255 4.59651C7.40605 4.59675 7.39092 4.64338 7.42027 4.66505L7.64708 4.83253L7.562 5.10133C7.55101 5.13612 7.59062 5.16493 7.62035 5.14369L7.84971 4.97975L8.07908 5.14369C8.10881 5.16493 8.14836 5.13612 8.13743 5.10133L8.05235 4.83253L8.2791 4.66505C8.30845 4.64338 8.29332 4.59675 8.25682 4.59651L7.9749 4.59437L7.88573 4.32692C7.87419 4.29231 7.82518 4.29231 7.81364 4.32692Z" fill="#F5F5F5"/>
            <path d="M7.81364 0.619316L7.72447 0.886771L7.44255 0.888908C7.40605 0.889152 7.39092 0.935782 7.42027 0.95745L7.64708 1.12493L7.562 1.39373C7.55101 1.42852 7.59062 1.45733 7.62035 1.43609L7.84971 1.27215L8.07908 1.43609C8.10881 1.45733 8.14836 1.42852 8.13743 1.39373L8.05235 1.12493L8.2791 0.95745C8.30845 0.935782 8.29332 0.889152 8.25682 0.888908L7.9749 0.886771L7.88573 0.619316C7.87419 0.584709 7.82518 0.584709 7.81364 0.619316Z" fill="#F5F5F5"/>
            <path d="M9.79973 4.32692L9.71056 4.59437L9.42864 4.59651C9.39214 4.59675 9.377 4.64338 9.40636 4.66505L9.6331 4.83253L9.54802 5.10133C9.53703 5.13612 9.57665 5.16493 9.60637 5.14369L9.83574 4.97975L10.0651 5.14369C10.0948 5.16493 10.1344 5.13612 10.1235 5.10133L10.0384 4.83253L10.2651 4.66505C10.2945 4.64338 10.2793 4.59675 10.2428 4.59651L9.96092 4.59437L9.87175 4.32692C9.86027 4.29231 9.81126 4.29231 9.79973 4.32692Z" fill="#F5F5F5"/>
            <path d="M11.787 4.32692L11.6979 4.59437L11.4159 4.59651C11.3794 4.59675 11.3643 4.64338 11.3937 4.66505L11.6205 4.83253L11.5354 5.10133C11.5244 5.13612 11.564 5.16493 11.5937 5.14369L11.8231 4.97975L12.0525 5.14369C12.0822 5.16493 12.1217 5.13612 12.1108 5.10133L12.0257 4.83253L12.2525 4.66505C12.2819 4.64338 12.2668 4.59675 12.2303 4.59651L11.9483 4.59437L11.8592 4.32692C11.8475 4.29231 11.7986 4.29231 11.787 4.32692Z" fill="#F5F5F5"/>
            <path d="M9.79973 0.619316L9.71056 0.886771L9.42864 0.888908C9.39214 0.889152 9.377 0.935782 9.40636 0.95745L9.6331 1.12493L9.54802 1.39373C9.53703 1.42852 9.57665 1.45733 9.60637 1.43609L9.83574 1.27215L10.0651 1.43609C10.0948 1.45733 10.1344 1.42852 10.1235 1.39373L10.0384 1.12493L10.2651 0.95745C10.2945 0.935782 10.2793 0.889152 10.2428 0.888908L9.96092 0.886771L9.87175 0.619316C9.86027 0.584709 9.81126 0.584709 9.79973 0.619316Z" fill="#F5F5F5"/>
            <path d="M11.787 0.619316L11.6979 0.886771L11.4159 0.888908C11.3794 0.889152 11.3643 0.935782 11.3937 0.95745L11.6205 1.12493L11.5354 1.39373C11.5244 1.42852 11.564 1.45733 11.5937 1.43609L11.8231 1.27215L12.0525 1.43609C12.0822 1.45733 12.1217 1.42852 12.1108 1.39373L12.0257 1.12493L12.2525 0.95745C12.2819 0.935782 12.2668 0.889152 12.2303 0.888908L11.9483 0.886771L11.8592 0.619316C11.8475 0.584709 11.7986 0.584709 11.787 0.619316Z" fill="#F5F5F5"/>
          </g>
        </svg>
      </NuxtLink>
    </div>
  </header>

  <div class="mx-auto mt-8">
    <div class="flex justify-between mb-4">
      <h2 class="text-3xl font-bold mb-4">Категории</h2>
    </div>
    <div class="sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
      <ul class="flex justify-between flex-wrap mb-20">
        <h2 v-show="cards.loading"><loading/></h2>
        <Card
          v-for="card in cards.data"
          :key="card._id"
          :title="card.category_name"
          :cardLink="card.link"
        />
      </ul>
    </div>
  </div>

  <footer class="mb-16">
    <div class="w-96 ml-auto">
      <h2 class="text-2xl">Панель администратора "Generator House"</h2>
      <p class="w-64 ml-auto">Cделано <a href="http://hyperNova.uz">"HyperNova.uz"</a></p>
    </div>
    <div class="mt-12 mb-6">
      <p class="text-xl"><b class="mr-2">Логин и пароль от админ-панели:</b>Никогда и никому не отдавай.</p>
      <p class="text-xl"><b class="mr-2">Если возникает ошибка:</b>связаться с <a href="http://hyperNova.uz" target="_blank">"HyperNova.uz"</a>.</p>
    </div>
    <div>
      <p class="text-xl"><b class="mr-2">Техническая поддержка: </b><a href="tel:+998944125626">+998 (94) 412-56-26</a></p>
      <p class="text-xl"><b class="mr-2">Телеграмм:</b><a href="https://t.me/HyperNova_Inc">@HyperNova_Inc</a></p>
    </div>
    <div>
    </div>
  </footer>
</template>

<script setup>
  import axios from "axios";

  onMounted(async() => {
    const token = await JSON.parse(localStorage.getItem('token'))
    if(!token) {
        await navigateTo('/auth');
    }
  })

  const logOut = async (e) => {
    localStorage.removeItem('token')
    await navigateTo('/auth')
  }

  const cards = ref({
    loading: false,
    error: false,
    data: []
  })

  async function getData() {
    try {
      cards.value.loading = true;
      const response = await axios.get('https://api.generatorhouse.uz/api/ru/categories');
      if(response.status == 200) {
        response.data.map(e => e.link = `/rus/card/${e._id}`)
        cards.value.data = response.data;
        cards.value.loading = false;
      } else {
        cards.error = true;
      }
    } catch (error) {
      console.error(error);
    }
  }

  getData()

</script>
